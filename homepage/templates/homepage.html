<!DOCTYPE html>
{% load static %}
{% load custom_tags %}
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>SwipeSaver</title>
    <link rel="stylesheet" href="{% static 'style.css' %}" />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet" />
</head>

<body>

    <div class="header-container">
        <div class="overlay-box"></div>
        <img alt="SwipeSaver" src="{% static 'final_logo.png' %}" />
        <h1>SWIPESAVER</h1>
    </div>

    <!-- Top-right user status -->
    <div class="user-status">
        {% if user.is_authenticated %}
        <span>Logged in as {{ user.username }}</span>
        <a href="{% url 'logout' %}">Logout</a>
        {% endif %}
    </div>

    <!-- Scroll Menu -->
    <div class="scrollmenu">
        <a href="{% url 'homepage' %}">Home</a>
        <a href="{% url 'commons' %}">Commons</a>
        <a href="{% url 'barh' %}">Barh</a>
        <a href="{% url 'russellsage' %}">Russell Sage</a>
        <a href="{% url 'blitman' %}">Blitman</a>
        <a href="#contact">Contact</a>
        <a href="#about">About</a>
        {% if not user.is_authenticated %}
        <a href="{% url 'login' %}">Login</a>
        <a href="{% url 'signup' %}">Sign Up</a>
        {% endif %}
    </div>

    <p id="time" class="time-display"></p>

    <div class="dining-halls-container">
        <!-- Commons -->
        <div class="image-container">
            <img src="{% static 'commons_cropped.png' %}" alt="Commons">
            <button class="title-overlay">
                <p>Commons</p>
            </button>
            <div class="panel">
                <hr class="solid-line">
                <p id="commons_status">Status: Checking...</p>
                <hr class="dashed-line">
                <div id="commons_distance"></div>
                <hr class="dashed-line">
                <p>View Menu: </p>
                <a href="{% url 'commons' %}">Commons Dining Hall</a>
                <hr class="dashed-line">
                <p id="commons_hours"></p>
                <hr class="dashed-line">
                <p>Rating:</p>
                <hr class="dashed-line">
            </div>
        </div>

        <!-- Russell Sage -->
        <div class="image-container">
            <img src="{% static 'sage_cropped.png' %}" alt="Sage">
            <button class="title-overlay">
                <p>Russell Sage</p>
            </button>
            <div class="panel">
                <hr class="solid-line">
                <p id="sage_status">Status: Checking...</p>
                <hr class="dashed-line">
                <div id="sage_distance"></div>
                <hr class="dashed-line">
                <p>View Menu: </p>
                <a href="{% url 'russellsage' %}">Russell Sage Dining Hall</a>
                <hr class="dashed-line">
                <p id="sage_hours"></p>
                <hr class="dashed-line">
                <p>Rating:</p>
                <hr class="dashed-line">
            </div>
        </div>
    </div>

    <div class="dining-halls-container">
        <!-- Blitman -->
        <div class="image-container">
            <img src="{% static 'blitman_cropped.png' %}" alt="Blitman">
            <button class="title-overlay">
                <p>Blitman</p>
            </button>
            <div class="panel">
                <hr class="solid-line">
                <p id="blitman_status">Status: Checking...</p>
                <hr class="dashed-line">
                <div id="blitman_distance"></div>
                <hr class="dashed-line">
                <p>View Menu: </p>
                <a href="#blitman">Blitman Dining Hall</a>
                <hr class="dashed-line">
                <p id="blitman_hours"></p>
                <hr class="dashed-line">
                <p>Rating:</p>
                <hr class="dashed-line">
            </div>
        </div>

        <!-- BARH -->
        <div class="image-container">
            <img src="{% static 'barh_cropped.png' %}" alt="BARH">
            <button class="title-overlay">
                <p>BARH</p>
            </button>
            <div class="panel">
                <hr class="solid-line">
                <p id="barh_status">Status: Checking...</p>
                <hr class="dashed-line">
                <div id="barh_distance"></div>
                <hr class="dashed-line">
                <p>View Menu: </p>
                <a href="{% url 'barh' %}">BARH Dining Hall</a>
                <hr class="dashed-line">
                <p id="barh_hours"></p>
                <hr class="dashed-line">
                <p>Rating:</p>
                <hr class="dashed-line">
            </div>
        </div>
    </div>

    <div class="footer">
        <p>An RCOS project</p>
        <button onclick="scrollToTop()" id="to_top">BACK TO TOP</button>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="{% static 'distanceTracker.js' %}"></script>
    <script>
        function getCurrentTime() {
            var date = new Date();
            var options = { timeZone: 'America/New_York', hour12: true };
            var timeString = date.toLocaleTimeString('en-US', options);
            document.getElementById("time").textContent = "Time in Troy NY (EST): " + timeString;
        }

        getCurrentTime();
        setInterval(getCurrentTime, 1000);
    </script>

    <script>
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }
    </script>

    <!-- Updated Script for Accordion Functionality -->
    <script>
        document.querySelectorAll(".title-overlay").forEach(button => {
            button.addEventListener("click", function() {
                const panel = this.nextElementSibling;

                // Toggle the 'open' class to control the visibility
                panel.classList.toggle("open");
            });
        });
    </script>

</body>
</html>
